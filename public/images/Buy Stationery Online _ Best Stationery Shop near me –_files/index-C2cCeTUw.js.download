import"./sentry-BYelf9eA.js";import{r as b,j as e,T as U,R as E}from"./react-core-agzC2jG9.js";import{H as j,O as B,J as D}from"./common-components-DaswJEKb.js";import{f as W}from"./components-CkUytsbX.js";import{h as F,f as H,e as q,b9 as $,bo as G,bp as K,bq as z,br as J,bs as Q,bt as V,bg as X,bu as Y,t as h,L as Z,bv as ee,bw as te,bx as re,by as se,bz as oe,bA as ne,bB as ae,bC as ie,bD as ce,bE as S,p as le,n as de,c as x,m as k}from"./lib-CqdmTbFZ.js";import{O as ue}from"./react-hot-toast-s2I5qXAA.js";import{u as L,B as _}from"./react-router-dom-BbyjoAyd.js";import"./assests-Bf0C5BUN.js";import"./ui-HAe6yHdY.js";import"./vendor-BD_VXsPn.js";import"./index-C2cCeTUw.js";import"./vendor-styling-DGvFwpaI.js";import"./react-ui-BnMhkHn2.js";import"./framer-nS2hVUg_.js";import"./checkout-components-Bv7kHl9D.js";import"./react-i18next-CAilhJL3.js";import"./auth-components-QHp9C0f4.js";import"./react-phone-input-j23sec0c.js";import"./js-cookie-CR4gOKBE.js";import"./i18next-BV-ixe_G.js";import"./upsell-components-aknFQhiw.js";import"./page-CartWrapper-BhXW-YdW.js";import"./page-empty-cart-CCuaFpPp.js";import"./cart-components-Lko3VvH5.js";import"./page-cart-WyDAUQtf.js";import"./page-DummyCart-B1J0Wrm1.js";import"./page-main-checkout-BMT95sJv.js";import"./axios-BvjBzqU3.js";import"./bowser-CCPOuGtF.js";import"./jwt-decode-pDWbxs0Y.js";import"./nanoid-CcPoVmVj.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},i=new t.Error().stack;i&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[i]="a286bd74-6e32-45bc-83b1-9f278f42726b",t._sentryDebugIdIdentifier="sentry-dbid-a286bd74-6e32-45bc-83b1-9f278f42726b")}catch{}})();(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&u(n)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function u(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();function Xe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const Ye=["/flo-checkout/api/attributes/v1/account-attributes",/\/kratos\/api\/v1\/checkout\/[^\/]+\/rewards/,/\/kratos\/api\/v1\/checkout\/[^\/]+\/upsell/,/\/kratos\/api\/v1\/checkout\/[^\/]+\/address\/[^\/]+\/etd/],pe="modulepreload",fe=function(t){return"/stable/"+t},C={},Ze=function(i,o,u){let r=Promise.resolve();if(o&&o.length>0){let p=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),a=n?.nonce||n?.getAttribute("nonce");r=p(o.map(c=>{if(c=fe(c),c in C)return;C[c]=!0;const d=c.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const l=document.createElement("link");if(l.rel=d?"stylesheet":pe,d||(l.as="script"),l.crossOrigin="",l.href=c,a&&l.setAttribute("nonce",a),document.head.appendChild(l),d)return new Promise((y,w)=>{l.addEventListener("load",y),l.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(n){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=n,window.dispatchEvent(a),!a.defaultPrevented)throw n}return r.then(n=>{for(const a of n||[])a.status==="rejected"&&s(a.reason);return i().catch(s)})};function me(){const{state:{isAuthenticating:t},actions:{setLoggedIn:i,setIsAuthenticating:o}}=F(),{state:{redirectUrl:u},actions:{setCheckoutId:r}}=H(),{actions:{setUserData:s,deleteAddressCache:n,updateUser:a}}=q(),[p,c]=L(),d=p.get("page")?.toLowerCase(),[f,l]=b.useState(!1),{isLoading:y}=$();b.useEffect(()=>{G(),T(),K(),w()},[d]);const w=()=>{const m=z(J.SHOPFLO_CHANNEL);return m.onMessage(g=>{g.type===Q.USER_LOGGED_OUT&&(r(""),s({uid:"",email:"",phone:"",name:"",default_billing_address:void 0,default_shipping_address:void 0,addresses:void 0,hasHomeAddr:!1,hasWorkAddr:!1}),n())}),()=>{m.close()}},T=async()=>{const m=p.get("auth"),g=p.get("forceRefresh"),{isLoggedIn:v,newTokensGenerated:M=!1}=await V(m??void 0,g==="true"||!!m);g==="true"&&v&&c(P=>(P.delete("auth"),P.delete("forceRefresh"),P)),i(v,{loginType:v?"COOKIE":void 0}),o(!1),M&&a()},N=()=>{window.history.pushState(null,"",null),l(!1),setTimeout(()=>{document?.documentElement?.style?.removeProperty("overflow")},500)},I=async()=>{l(!1),X(u)};return t&&d&&d!=="marketing-popup"?e.jsx(j,{"data-sentry-element":"Skeleton","data-sentry-component":"App","data-sentry-source-file":"App.tsx"}):e.jsxs(e.Fragment,{children:[e.jsx(W,{"data-sentry-element":"AppRouter","data-sentry-source-file":"App.tsx"}),e.jsx(ue,{"data-sentry-element":"Toaster","data-sentry-source-file":"App.tsx"}),!!y&&e.jsx(B,{}),e.jsx(D,{closeCheckout:I,isOpen:f,closePopup:N,"data-sentry-element":"CheckoutExitPopup","data-sentry-source-file":"App.tsx"})]})}Y();const O=new URLSearchParams(window.location.search),R=O.get("page")?.toLowerCase(),he=O.get("page")==="marketing-popup",ge=document.getElementById("root"),A=U.createRoot(ge),xe=h()&&!Z()&&!["cart","empty-cart","login-status-check","ghost-modal","marketing-popup","experiments-widget"].includes(R??"");xe?A.render(e.jsx(E.StrictMode,{children:e.jsx(_,{basename:"/stable",children:e.jsx(be,{})})})):A.render(e.jsx(E.StrictMode,{children:e.jsx(_,{basename:"/stable",children:e.jsx(ee,{children:e.jsx(te,{children:e.jsx(re,{children:e.jsx(se,{children:e.jsx(ye,{children:e.jsx(b.Suspense,{fallback:he?e.jsx(e.Fragment,{}):e.jsx(j,{}),children:e.jsx(oe,{children:e.jsx(ne,{children:e.jsx(ae,{children:e.jsx(ie,{children:e.jsx(ce,{children:e.jsx(me,{})})})})})})})})})})})})})}));function be(){return S(),b.useEffect(()=>{const t=new URL(document.location.href);le(de.PARENT_REDIRECT,{redirectUrl:t.href,clearCart:!1,isSso:R==="login-sso"})},[]),e.jsx(j,{"data-sentry-element":"Skeleton","data-sentry-component":"RedirectWrapper","data-sentry-source-file":"index.tsx"})}function ye({children:t}){const[i]=L(),o=i.get("page"),u=["cart","empty-cart"].includes(o?.toLowerCase()??""),r=o==="login-sso",s=o==="marketing-popup",n=o==="wishlist",a=o==="mock-checkout",p=o==="experiments-widget";return S(),s?e.jsx("div",{id:"checkout-ui-root",className:x("relative overflow-hidden md:h-fit md:w-[25rem] w-full","md:shadow-[0px_0px_10px_0px_rgba(0,0,0,0.1)]"),children:t}):u?e.jsx("div",{id:"checkout-ui-root",className:"relative h-full w-full overflow-hidden bg-gray-lightest md:h-[85vh] md:w-[25rem] md:rounded-l-[28px] md:rounded-r-none  md:shadow-[0px_0px_10px_0px_rgba(0,0,0,0.1)]",children:t}):r?e.jsx("div",{className:`flex h-full w-full overflow-hidden bg-gray-lighter ${h()?"justify-center":"flex-col items-center justify-center"}`,children:e.jsx("div",{className:x("h-[400px] w-[360px] border border-carbon-lighter bg-white md:h-[400px]",k()?"rounded-xl":"relative w-[360px] rounded-[20px] md:w-[360px]",h()?"!w-full !rounded-xl":""),children:t})}):n?e.jsx("div",{className:"h-full w-full overflow-hidden bg-transparent",children:t}):a?e.jsx("div",{id:"checkout-ui-root",className:x("relative h-full w-full bg-gray-lightest md:h-[85vh] md:w-[69rem]",k()?"":h()?"rounded-[28px]":"md:rounded-[28px]","md:shadow-[0px_0px_10px_0px_rgba(0,0,0,0.1)]"),children:t}):p?e.jsx("div",{className:"h-full w-full overflow-hidden bg-transparent",children:t}):e.jsx("div",{id:"checkout-ui-root",className:x("relative h-full w-full overflow-hidden bg-gray-lightest md:h-[85vh] md:w-[25rem]",k()?"":h()?"rounded-[28px]":"md:rounded-[28px]","md:shadow-[0px_0px_10px_0px_rgba(0,0,0,0.1)]"),"data-sentry-component":"Apsshell","data-sentry-source-file":"index.tsx",children:t})}window.addEventListener("vite:preloadError",()=>{window.location.reload()});export{Ye as A,Ze as _,Xe as g};
//# sourceMappingURL=index-C2cCeTUw.js.map
